<!doctype html>
<html>

<head>
  <title>Demo</title>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
    }
    .note {
      padding: 20px;
      background-color: lavenderblush;
    }
    .holder {
      display: flex;
    }
  </style>
    
	<script src="./shims/webcomponents.polyfill-loader.js"></script>
	<script type="text/javascript">

		if ((thisBrowserType() == "isFirefox") || thisBrowserType() == "isEdge") {

			loadJS('./shims/custom-elements.min.js');
			loadJS('./shims/native-shim.js');

		}
		else if (thisBrowserType() == "isChrome" || thisBrowserType() == "isSafari") {
			loadJS('./shims/webcomponents-loader.js')
			
		}

		loadJS('./shims/custom-event-polyfill.js')

	</script>
	
</head>

<body>
<input id="hidden-file-input" type="file" hidden></input>
  <p>
    This is an example of initializing a pie item using the files generated by pie pack.
    <div class="note">
      This must be run via a http server, not using the file system.
    </div>
  </p>
  
  <!-- Uncomment below div to see category element -->
  <div class="category">
    <table>
            <tr>
                <td style="width:70%"><categorize-el-configure pie-id="2"></categorize-el-configure></td>
                <td style="width:2%;background-color:#eee"></td>
                <td style="vertical-align:top">
                    <div>STUDENT VIEW &nbsp <span id="check-answer">Check Answer</span></div>
                    <categorize-el pie-id="2"> </categorize-el>
                </td>
            </tr>
    </table>
  </div>
   <!-- Category element end -->
  
  <script src="./jquery-1.11.1.min.js"></script>
  <script src="./main.js" defer></script>
  <!-- Category related js -->
  <script src="./pie/pie-configure.js" defer ></script>
  <script src="./pie/pie-controllers.js" defer></script>
  <script src="./pie/pie-view.js" defer></script>
  <script src="./cat/cat_main.js" defer></script>
   <!---->

  <script type="text/javascript" defer>

    document.addEventListener('DOMContentLoaded', () => {

      document.querySelector("#check-answer").addEventListener('click', () => {
        env = { mode: 'evaluate' }
        const s = window.session.find(s => s.id === "2");
        window['pie-controller-pie-item']["categorize-el"].model(window.mcModel, s, env)
          .then(uiModel => {

            const id = "2";
            let a = "categorize-el[pie-id='" + id + "']";
            let el = document.querySelector(a);
            el.model = uiModel;
          })
      })
    })
    $.getJSON("./cat/config2.json", function (data) {
      data.models.forEach((val) => {
        const model = val;

        window.mcModel = model;
        renderPIE(window.mcModel, 'categorize-el');
      });
    });
  </script>
  
</body>

</html>

